<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moonlight on Maple Hollow - A Paranormal Romance</title>
    
    <!-- 
    ==========================================
    IMAGE PLACEHOLDERS - ADD YOUR URLS HERE:
    ==========================================
    
    Search for these comments to add your images:
    
    1. "Book Cover Placeholder" - Line ~95
       Replace placeholder div with: <img src="YOUR_BOOK_COVER_URL" ... />
    
    2. "Ethan Image Placeholder" - Line ~280
       Replace placeholder div with: <img src="YOUR_ETHAN_IMAGE_URL" ... />
    
    3. "Caleb Image Placeholder" - Line ~310
       Replace placeholder div with: <img src="YOUR_CALEB_IMAGE_URL" ... />
    
    ==========================================
    -->
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Markdown rendering and sanitization for chapter previews -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Source+Sans+Pro:wght@300;400;600;700&family=Lora:wght@400;500&display=swap');

        :root {
            /* Theme palette (from mockup) */
            --warm-cream: #F5EFE7;
            --honey-amber: #D4A574;
            --golden-glow: #F4D58D;
            --twilight-cocoa: #2D1810;
            --mid-cocoa: #3D2820;
            --deep-cocoa: #2D1810;
            --autumn-rust: #B8733E;
            --rust: #8B5A2B;
            --soft-moonlight: #FFF8E7;
            --misty-lavender: #D4C4D8;
            --warm-charcoal: #3D3028;
            --soft-sage: #B8C5B0;
            --cozy-rose: #D4A5A5;
            /* Fog tones */
            --fog-a: rgba(245, 239, 231, 0.03);
            --fog-b: rgba(245, 239, 231, 0.08);
            --fog-c: rgba(245, 239, 231, 0.03);
        }
        
        body {
            /* Typography: shift to bookish, grounded serif */
            font-family: 'Lora', serif;
            color: var(--warm-cream);
            background: linear-gradient(180deg, var(--twilight-cocoa) 0%, var(--mid-cocoa) 50%, var(--twilight-cocoa) 100%);
            position: relative; /* for texture overlay stacking */
        }

        /* Subtle site-wide texture overlay for gritty, tactile feel */
        :root {
            /* Inline SVG noise texture; repeated with very low opacity */
            --noise-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: var(--noise-texture);
            background-repeat: repeat;
            opacity: 0.04; /* start very low; bump to 0.06-0.08 if you want more grit */
            pointer-events: none;
            z-index: 0;
        }
        
        .heading-font {
            font-family: 'Cormorant Garamond', serif;
        }
        
        .fog-effect {
            background: linear-gradient(180deg, var(--fog-a) 0%, var(--fog-b) 50%, var(--fog-c) 100%);
            animation: fogDrift 20s ease-in-out infinite;
        }
        
        @keyframes fogDrift {
            0%, 100% { opacity: 0.3; transform: translateX(0); }
            50% { opacity: 0.6; transform: translateX(20px); }
        }
        
        @keyframes moonGlow {
            0%, 100% { box-shadow: 0 0 40px rgba(244, 213, 141, 0.5); }
            50% { box-shadow: 0 0 80px rgba(244, 213, 141, 0.7); }
        }
        
        .moon-glow {
            animation: moonGlow 4s ease-in-out infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 1s ease-out forwards;
        }
        
        .autumn-gradient {
            background: linear-gradient(135deg, var(--honey-amber) 0%, var(--autumn-rust) 50%, var(--rust) 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        
        .timeline-dot {
            transition: all 0.3s ease;
        }
        
        .timeline-dot:hover {
            transform: scale(1.3);
        }

        /* Texture overlay for individual cards/panels */
        .card-texture-overlay {
            position: relative;
            z-index: 1;
        }
        .card-texture-overlay::after {
            content: '';
            position: absolute;
            inset: 0;
            background-image: var(--noise-texture);
            background-repeat: repeat;
            opacity: 0.06;
            pointer-events: none;
            border-radius: inherit;
        }

        /* Reader spacing fallback if typography plugin isn't present */
        .chapter-content p { margin-bottom: 1.25em; }
        
        /* Wood texture background for journey section */
        .plank-shadow {
            position: relative;
        }
        
        .plank-shadow::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url('https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/texture-leaf.png');
            background-repeat: repeat;
            background-size: auto;
            opacity: 0.05;
            pointer-events: none;
            z-index: -1;
        }
        
        /* Background images for tab sections */
        .bg-image-1 {
            position: relative;
        }
        
        .bg-image-1::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url('https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/moonlight-on-maple-hollow-4.png');
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
            opacity: 0.08;
            pointer-events: none;
            z-index: -1;
        }
        
        .bg-image-2 {
            position: relative;
        }
        
        .bg-image-2::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url('https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/moonlight-on-maple-hollow-3.png');
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
            opacity: 0.08;
            pointer-events: none;
            z-index: -1;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Shared chapters list for navigation and reader
        const CHAPTERS = [
            { id: 1,  title: 'Chapter 1 — Homecoming Fog',                 file: 'chapter-1-homecoming-fog.md',               blurb: 'Ethan returns to Maple Hollow through the mist.' },
            { id: 2,  title: 'Chapter 2 — Alpha at the Bar',               file: 'chapter-2-alpha-at-the-bar.md',             blurb: 'Old wounds resurface under warm tavern lights.' },
            { id: 3,  title: 'Chapter 3 — Lanterns and Laughter',          file: 'chapter-3-lanterns-and-laughter.md',        blurb: 'Festival magic begins at dusk in Harvest Square.' },
            { id: 4,  title: 'Chapter 4 — Quiet Patrol',                    file: 'chapter-4-quiet-patrol.md',                 blurb: 'Caleb walks the town’s boundary and hears what needs care.' },
            { id: 5,  title: 'Chapter 5 — Welcome, Maple Hollow',          file: 'chapter-5-welcome-maple-hollow.md',         blurb: 'Opening ceremony—welcome becomes a shared promise.' },
            { id: 6,  title: 'Chapter 6 — Late-Shift Glow',                 file: 'chapter-6-late-shift-glow.md',              blurb: 'A quiet café becomes a place for careful honesty.' },
            { id: 7,  title: 'Chapter 7 — The Interview That Became Breakfast', file: 'chapter-7-the-interview-that-became-breakfast.md', blurb: 'Questions turn into truths at Aunt Sophie’s table.' },
            { id: 8,  title: 'Chapter 8 — Storm Signs',                      file: 'chapter-8-storm-signs.md',                  blurb: 'The weather turns and so do expectations.' },
            { id: 9,  title: 'Chapter 9 — Shelter and Sparks',              file: 'chapter-9-shelter-and-sparks.md',           blurb: 'Forced closeness reveals warmth neither expected.' },
            { id: 10, title: 'Chapter 10 — Words on Fire',                  file: 'chapter-10-words-on-fire.md',               blurb: 'Truths ignite; the town listens.' },
            { id: 11, title: 'Chapter 11 — Bridges Before Dawn',            file: 'chapter-11-bridges-before-dawn.md',         blurb: 'Before sunrise, they choose how to cross.' },
            { id: 12, title: 'Chapter 12 — Flour and Firelight',            file: 'chapter-12-flour-and-firelight.md',         blurb: 'Domestic intimacy, hands steady in shared work.' },
            { id: 13, title: 'Chapter 13 — The Morning After the Moon',     file: 'chapter-13-the-morning-after-the-moon.md',  blurb: 'New beginnings in the soft light.' },
        ];

        // Fix common mojibake sequences from mis-decoded UTF-8 smart punctuation
        const fixMojibake = (s) => {
            if (!s || typeof s !== 'string') return s;
            return s
                .replace(/â€™/g, '’')  // right single quote
                .replace(/â€˜/g, '‘')  // left single quote
                .replace(/â€œ/g, '“')  // left double quote
                .replace(/â€/g, '”')  // right double quote
                .replace(/â€“/g, '–')  // en dash
                .replace(/â€”/g, '—')  // em dash
                .replace(/â€¦/g, '…')  // ellipsis
                .replace(/Â /g, ' ')   // stray non-breaking space marker
                ;
        };

        const MoonlightPromo = () => {
            const tabs = ['home', 'story', 'supernatural', 'characters', 'journey', 'themes', 'academy'];
            const initialTab = (() => {
                try {
                    const h = window.location.hash ? window.location.hash.slice(1) : '';
                    return tabs.includes(h) ? h : 'home';
                } catch { return 'home'; }
            })();
            const [activeTab, setActiveTab] = useState(initialTab);
            const [hoveredChapter, setHoveredChapter] = useState(null);
            const [selectedQuote, setSelectedQuote] = useState(0);
            
            const quotes = [
                {
                    text: "Mist swallowed the last road sign before Maple Hollow—appropriate for a place that preferred its secrets blurred.",
                    chapter: "Chapter 1"
                },
                {
                    text: "Magic, to Maple Hollow, wasn't mystic or even particularly special—just another local industry, like maple syrup or gossip.",
                    chapter: "Chapter 1"
                },
                {
                    text: "The name rose like a moon in his chest—bright, inevitable, and completely unwelcome.",
                    chapter: "Chapter 2"
                },
                {
                    text: "He'd been a good Alpha with a particular kind of tension underneath everything.",
                    chapter: "Chapter 2"
                }
            ];
            
            const journeyPoints = [
                { chapter: 1, title: "Homecoming Fog", emotion: "Returning to haunted memories", color: "bg-slate-600" },
                { chapter: 2, title: "Alpha at the Bar", emotion: "Old wounds resurface", color: "bg-amber-700" },
                { chapter: 3, title: "Lanterns and Laughter", emotion: "Festival magic begins", color: "bg-orange-600" },
                { chapter: 5, title: "Welcome, Maple Hollow", emotion: "Community embrace", color: "bg-yellow-700" },
                { chapter: 7, title: "The Interview", emotion: "Professional masks slip", color: "bg-amber-600" },
                { chapter: 9, title: "Shelter and Sparks", emotion: "Storm forces closeness", color: "bg-orange-700" },
                { chapter: 10, title: "Words on Fire", emotion: "Truths ignite", color: "bg-red-800" },
                { chapter: 12, title: "Flour and Firelight", emotion: "Domestic intimacy", color: "bg-amber-500" },
                { chapter: 13, title: "Morning After the Moon", emotion: "New beginnings", color: "bg-yellow-600" }
            ];
            
            useEffect(() => {
                const interval = setInterval(() => {
                    setSelectedQuote(prev => (prev + 1) % quotes.length);
                }, 6000);
                return () => clearInterval(interval);
            }, []);

            // Keep URL hash in sync for deep-linking (#home, #chapters etc.)
            useEffect(() => {
                try {
                    const target = `#${activeTab}`;
                    if (window.location.hash !== target) {
                        history.replaceState(null, '', target);
                    }
                } catch {}
            }, [activeTab]);

            // Respond to browser hash changes (back/forward)
            useEffect(() => {
                const onHash = () => {
                    try {
                        const h = window.location.hash ? window.location.hash.slice(1) : '';
                        if (tabs.includes(h)) setActiveTab(h);
                    } catch {}
                };
                window.addEventListener('hashchange', onHash);
                return () => window.removeEventListener('hashchange', onHash);
            }, []);
            
            return (
                <div className="min-h-screen">
                    {/* Navigation Tabs (sticky, always at top) */}
                    
                    <div className="md:sticky md:top-0 z-50 bg-zinc-900/95 backdrop-blur border-b border-amber-800/30">
                        <div className="max-w-6xl mx-auto px-6 py-4">
                            <div className="flex gap-2 md:gap-4 items-center justify-center md:justify-between flex-wrap">
                                {[
                                    { key: 'home', label: 'Home', icon: '🏠' },
                                    { key: 'story', label: 'Story', icon: '📖' },
                                    { key: 'supernatural', label: 'Supernatural', icon: '🌙' },
                                    { key: 'characters', label: 'Characters', icon: '👥' },
                                    { key: 'journey', label: 'Journey', icon: '🗺️' },
                                    { key: 'themes', label: 'Themes', icon: '✨' },
                                    { key: 'academy', label: 'Academy', icon: '🎓' }
                                ].map(tab => (
                                    <button
                                        key={tab.key}
                                        onClick={() => setActiveTab(tab.key)}
                                        className={`px-3 md:px-6 py-2 rounded-lg transition-all text-sm md:text-base ${
                                            activeTab === tab.key 
                                                ? 'bg-amber-700 text-white' 
                                                : 'text-amber-300 hover:text-amber-100 hover:bg-amber-900/30'
                                        }`}
                                        title={tab.label}
                                    >
                                        <span className="md:hidden">{tab.icon}</span>
                                        <span className="hidden md:inline">{tab.label}</span>
                                    </button>
                                ))}

                                {/* Chapters quick-jump dropdown */}
                                <div className="w-full md:w-auto md:ml-auto">
                                    <label htmlFor="chapterJump" className="sr-only">Jump to chapter</label>
                                    <select
                                        id="chapterJump"
                                        className="w-full md:w-auto bg-zinc-900/40 border border-amber-800/30 text-amber-200 rounded px-3 py-2"
                                        onChange={(e) => {
                                            const idx = Number(e.target.value);
                                            if (!Number.isNaN(idx)) {
                                                setActiveTab('chapters');
                                                try { history.replaceState(null, '', '#chapters'); } catch {}
                                                window.dispatchEvent(new CustomEvent('chapters:select', { detail: idx }));
                                            }
                                        }}
                                        defaultValue=""
                                    >
                                        <option value="" disabled>Jump to chapter…</option>
                                        {CHAPTERS.map((c, idx) => (
                                            <option key={c.id} value={idx}>{c.title}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Home Section */}
                    {activeTab === 'home' && (
                        <div className="relative min-h-screen overflow-hidden z-40">
                            <div className="absolute inset-0" style={{
                                backgroundImage: 'url(https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/moonlight-on-maple-hollow-7.png)',
                                backgroundSize: 'cover',
                                backgroundPosition: 'center',
                                backgroundRepeat: 'no-repeat',
                                filter: 'blur(2px)'
                            }}></div>
                            <div className="absolute inset-0 fog-effect"></div>
                            <div className="max-w-6xl mx-auto px-6 py-20 pt-32 relative z-10">
                                <div className="grid md:grid-cols-3 gap-8 mb-8">
                                    {/* Book Cover Card */}
                                    <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay flex items-center justify-center">
                                        <div className="w-64 h-96 md:w-full md:h-[480px] bg-gradient-to-br from-[#D4A574]/60 to-[#B8733E]/60 rounded-lg border-2 shadow-2xl overflow-hidden flex items-center justify-center" style={{ borderColor: 'var(--honey-amber)' }}>
                                            <img src="https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/maple-hollow-cover.png" alt="Moonlight on Maple Hollow Book Cover" className="w-full h-full object-cover rounded-lg" />
                                        </div>
                                    </div>
                                    
                                    {/* Title & Description Card */}
                                    <div className="md:col-span-2 bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                        <h1 className="heading-font text-4xl md:text-6xl font-bold mb-4 text-amber-100">
                                            Moonlight on Maple Hollow
                                        </h1>
                                        <p className="text-2xl md:text-3xl text-amber-200 mb-6 italic">
                                            A Paranormal Romance
                                        </p>
                                        <p className="text-lg md:text-xl text-amber-300 leading-relaxed">
                                            When a skeptical journalist returns to his magical hometown, he must face the werewolf Alpha who broke his heart—and the supernatural forces that demand truth under the Harvest Moon's power.
                                        </p>
                                    </div>
                                </div>
                                
                                {/* Genre Badges Card */}
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h3 className="heading-font text-2xl font-semibold text-amber-200 mb-4 text-center">
                                        What You'll Find Inside
                                    </h3>
                                    <div className="flex gap-4 justify-center flex-wrap text-sm">
                                        <span className="px-4 py-2 bg-amber-900/50 rounded-full border border-amber-600">🐺 Werewolf Romance</span>
                                        <span className="px-4 py-2 bg-amber-900/50 rounded-full border border-amber-600">🌙 Harvest Moon Magic</span>
                                        <span className="px-4 py-2 bg-amber-900/50 rounded-full border border-amber-600">✨ Shifter Pack</span>
                                        <span className="px-4 py-2 bg-amber-900/50 rounded-full border border-amber-600">🔮 Small Town Magic</span>
                                        <span className="px-4 py-2 bg-amber-900/50 rounded-full border border-amber-600">💫 Second Chance</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Story Section */}
                    {activeTab === 'story' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-1 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-8 text-center">
                                The Story
                            </h2>
                            
                            <div className="grid md:grid-cols-2 gap-12 mb-16">
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🌙 The Supernatural World
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        Maple Hollow is a town where werewolves, witches, and humans have coexisted openly since the 1920s. The local Alpha runs the tavern, werebears operate the lumber mill, and witches sell protection charms at the farmer's market.
                                    </p>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        But the Harvest Moon brings danger—it amplifies all emotions, forcing hidden truths to surface. When shifters struggle for control, their emotional energy can "leak" into the human population, and the magical wards that protect the town begin to fray.
                                    </p>
                                </div>
                                
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🐺 The Alpha & The Human
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        Twelve years ago, Ethan fled when he discovered his boyfriend Caleb was a werewolf—and heir to the Alpha position. Now Ethan's back to cover the Harvest Moon Festival, unaware that the moon's magic won't let him hide his feelings anymore.
                                    </p>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        Caleb has spent years protecting his pack and maintaining the delicate balance between the supernatural and human worlds. But with Ethan's return and the Harvest Moon amplifying every emotion, his legendary control begins to crack—and the entire town feels it.
                                    </p>
                                </div>
                            </div>
                            
                            {/* Rotating Quotes */}
                            <div className="bg-gradient-to-br from-amber-900/40 to-orange-900/40 p-12 rounded-lg border border-amber-600/40 text-center">
                                <div className="max-w-3xl mx-auto">
                                    <p className="heading-font text-3xl italic text-amber-100 mb-4 min-h-24 flex items-center justify-center">
                                        "{quotes[selectedQuote].text}"
                                    </p>
                                    <p className="text-amber-300 text-sm">
                                        — {quotes[selectedQuote].chapter}
                                    </p>
                                </div>
                                <div className="flex gap-2 justify-center mt-6">
                                    {quotes.map((_, idx) => (
                                        <button
                                            key={idx}
                                            onClick={() => setSelectedQuote(idx)}
                                            className={`w-2 h-2 rounded-full transition-all ${
                                                selectedQuote === idx ? 'bg-amber-400 w-8' : 'bg-amber-700'
                                            }`}
                                        />
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Supernatural Section */}
                    {activeTab === 'supernatural' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-2 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-8 text-center">
                                The Supernatural World
                            </h2>
                            <p className="text-xl text-amber-300 text-center mb-12 max-w-3xl mx-auto">
                                In Maple Hollow, magic isn't hidden—it's woven into everyday life. But during the Harvest Moon, 
                                the boundaries between human and supernatural blur dangerously.
                            </p>
                            
                            {/* The Pack */}
                            <div className="bg-gradient-to-br from-amber-900/60 to-orange-900/60 p-8 rounded-lg border border-amber-700 mb-8 card-texture-overlay">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4 flex items-center gap-3">
                                    <span className="text-4xl">🐺</span> The Maple Hollow Pack
                                </h3>
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <p className="text-amber-100/90 leading-relaxed mb-4">
                                            <strong className="text-amber-200">The Alpha's Burden:</strong> Caleb inherited leadership at 24 when his father passed. 
                                            As Alpha, he doesn't just lead—he literally feels his pack's emotions, carries their struggles, and must maintain 
                                            control even when the moon demands surrender.
                                        </p>
                                        <p className="text-amber-100/90 leading-relaxed">
                                            <strong className="text-amber-200">Pack Dynamics:</strong> The pack isn't just a group—they're psychically linked. 
                                            During the full moon, emotions ripple through the pack bond like wildfire. One member's anger can ignite the whole pack's fury.
                                        </p>
                                    </div>
                                    <div>
                                        <p className="text-amber-100/90 leading-relaxed mb-4">
                                            <strong className="text-amber-200">Shifting Rituals:</strong> Transformation happens communally in designated safe spaces. 
                                            The Wildwood Tavern has special "shift rooms" warded for protection. Public shifting is celebrated during festivals but 
                                            carefully controlled.
                                        </p>
                                        <p className="text-amber-100/90 leading-relaxed">
                                            <strong className="text-amber-200">The Wolf Within:</strong> Each shifter has a wolf consciousness—not separate, but another 
                                            facet of themselves. The wolf sees truth, feels deeply, and can't lie. This becomes crucial when Ethan returns.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            {/* The Harvest Moon */}
                            <div className="bg-gradient-to-br from-slate-800/60 to-slate-900/60 p-8 rounded-lg border border-slate-700 mb-8 card-texture-overlay">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4 flex items-center gap-3">
                                    <span className="text-4xl">🌙</span> The Harvest Moon's Power
                                </h3>
                                <div className="space-y-4 text-amber-100/90">
                                    <p className="leading-relaxed">
                                        <strong className="text-amber-300">Emotional Amplification:</strong> The Harvest Moon doesn't create feelings—it amplifies what's already there. 
                                        Love becomes overwhelming, anger turns volcanic, and secrets refuse to stay buried. For shifters, this effect is tripled.
                                    </p>
                                    <p className="leading-relaxed">
                                        <strong className="text-amber-300">Truth Compulsion:</strong> The moon reveals truth. Any secret kept through the full lunar cycle will find a way 
                                        to expose itself. Ethan's hidden feelings, Caleb's suppressed desires—nothing stays hidden under the Harvest Moon.
                                    </p>
                                    <p className="leading-relaxed">
                                        <strong className="text-amber-300">Sacred Bonds:</strong> Connections formed during the Harvest Moon are considered sacred and lifelong. 
                                        This is why Caleb and Ethan's reunion during this time is so significant—and dangerous.
                                    </p>
                                    <p className="leading-relaxed">
                                        <strong className="text-amber-300">The Emotional Leak:</strong> When the pack struggles for control, their amplified emotions can "leak" into 
                                        the human population. Suddenly, the whole town feels inexplicably angry, sad, or aroused—leading to the crisis in Chapter 10.
                                    </p>
                                </div>
                            </div>
                            
                            {/* The Magic System */}
                            <div className="grid md:grid-cols-3 gap-6 mb-8">
                                <div className="bg-zinc-900/60 p-6 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h4 className="heading-font text-2xl font-semibold text-amber-200 mb-3 flex items-center gap-2">
                                        <span className="text-2xl">🔮</span> Ward Magic
                                    </h4>
                                    <p className="text-amber-100/90 text-sm leading-relaxed">
                                        Magical ribbons and stones create protective boundaries around the town. They contain supernatural 
                                        energy and maintain the balance between worlds. When they fray, chaos follows.
                                    </p>
                                </div>
                                
                                <div className="bg-zinc-900/60 p-6 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h4 className="heading-font text-2xl font-semibold text-amber-200 mb-3 flex items-center gap-2">
                                        <span className="text-2xl">🌿</span> Witch Craft
                                    </h4>
                                    <p className="text-amber-100/90 text-sm leading-relaxed">
                                        Local witches like Mara don't cast flashy spells—they weave protection into everyday items. 
                                        Sachets of herbs, blessed ribbons, and charged stones keep the town's magic in balance.
                                    </p>
                                </div>
                                
                                <div className="bg-zinc-900/60 p-6 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h4 className="heading-font text-2xl font-semibold text-amber-200 mb-3 flex items-center gap-2">
                                        <span className="text-2xl">📜</span> The Hollow Accord
                                    </h4>
                                    <p className="text-amber-100/90 text-sm leading-relaxed">
                                        A magical contract from the 1920s that governs coexistence. No violence within town borders, 
                                        no shifting for intimidation, and all disputes settled through ritual or council.
                                    </p>
                                </div>
                            </div>
                            
                            {/* The Stakes */}
                            <div className="bg-gradient-to-br from-red-900/40 to-orange-900/40 p-8 rounded-lg border border-red-700/50 card-texture-overlay">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                    ⚡ The Supernatural Stakes
                                </h3>
                                <p className="text-amber-100/90 leading-relaxed mb-4">
                                    This isn't just a romance—it's about two worlds colliding. When Ethan's article about the pack's emotional influence leaks, 
                                    it threatens to destroy decades of peaceful coexistence. The town turns suspicious, the pack grows defensive, and the 
                                    already-strained wards begin to crack.
                                </p>
                                <p className="text-amber-100/90 leading-relaxed">
                                    Caleb must choose between his duty as Alpha and his love for Ethan. Ethan must decide if he can accept all of Caleb—human 
                                    and wolf. And both must face the truth that their love might be the key to saving Maple Hollow's magical balance... or destroying it.
                                </p>
                            </div>
                            
                            {/* Fun Facts */}
                            <div className="mt-8 bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-6 text-center">
                                    Supernatural Details You'll Love
                                </h3>
                                <div className="grid md:grid-cols-2 gap-6 text-amber-100/90">
                                    <ul className="space-y-3">
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>Caleb's eyes glow gold when his wolf is close to the surface</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>The pack can sense lies—making Ethan's return very complicated</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>Mrs. Chen shifts into a wolf to run patrol, then sells pastries the next morning</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>The Wildwood Tavern is built on a ley line, making it a supernatural nexus</span>
                                        </li>
                                    </ul>
                                    <ul className="space-y-3">
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>Alpha commands carry magical weight—Caleb rarely uses this power</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>The town's weather responds to supernatural emotional states</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>Shifter body temperature runs hot—important for those intimate scenes</span>
                                        </li>
                                        <li className="flex gap-2">
                                            <span className="text-amber-400">•</span>
                                            <span>The morning after the full moon, the whole town needs extra coffee</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Characters Section */}
                    {activeTab === 'characters' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-1 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-8 text-center">
                                Meet the Characters
                            </h2>
                            
                            <div className="grid md:grid-cols-2 gap-8 mb-8">
                                {/* Ethan Card */}
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <div className="flex items-start gap-6 mb-6">
                                        {/* Ethan Image */}
                                        <div className="w-24 h-24 rounded-2xl overflow-hidden border-4 border-amber-600 flex-shrink-0 shadow-lg">
                                            <img src="https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/mc-1-ethan-v2.png" alt="Ethan Cole" className="w-full h-full object-cover object-center scale-110" />
                                        </div>
                                        <div className="flex-1">
                                            <h3 className="heading-font text-3xl font-bold text-amber-200 mb-2">Ethan Cole</h3>
                                            <p className="text-amber-300 text-lg italic mb-4">The Skeptical Journalist</p>
                                        </div>
                                    </div>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        Twelve years ago, Ethan fled Maple Hollow when he discovered his boyfriend was a werewolf. Now he's back as a journalist, armed with skepticism and unresolved feelings. But the Harvest Moon has other plans for his carefully guarded heart.
                                    </p>
                                    <p className="text-amber-300 text-sm">
                                        <strong>Age:</strong> 30 • <strong>Role:</strong> Investigative Journalist • <strong>Weakness:</strong> Can't resist the truth
                                    </p>
                                </div>
                                
                                {/* Caleb Card */}
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <div className="flex items-start gap-6 mb-6">
                                        {/* Caleb Image */}
                                        <div className="w-24 h-24 rounded-2xl overflow-hidden border-4 border-amber-400 flex-shrink-0 shadow-lg">
                                            <img src="https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/mc-2-caleb-2.png" alt="Caleb Hawthorne" className="w-full h-full object-cover object-center scale-125" />
                                        </div>
                                        <div className="flex-1">
                                            <h3 className="heading-font text-3xl font-bold text-amber-200 mb-2">Caleb Hawthorne</h3>
                                            <p className="text-amber-300 text-lg italic mb-4">The Patient Alpha</p>
                                        </div>
                                    </div>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        As Alpha of the Maple Hollow pack, Caleb has spent years protecting his town and maintaining the balance between worlds. But Ethan's return threatens his legendary control—and awakens the wolf who never stopped calling him mate.
                                    </p>
                                    <p className="text-amber-300 text-sm">
                                        <strong>Age:</strong> 32 • <strong>Role:</strong> Pack Alpha • <strong>Weakness:</strong> One stubborn journalist
                                    </p>
                                </div>
                            </div>
                            
                            {/* Supporting Characters Card */}
                            <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-6 text-center flex items-center justify-center gap-3">
                                    <span className="text-4xl">👥</span> The Supporting Cast
                                </h3>
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 className="text-amber-300 font-semibold mb-2 flex items-center gap-2">
                                            <span>🔮</span> Mara - The Pack Witch
                                        </h4>
                                        <p className="text-amber-100/90 text-sm mb-4">Maintains the magical wards and knows exactly what the moon wants.</p>
                                        
                                        <h4 className="text-amber-300 font-semibold mb-2 flex items-center gap-2">
                                            <span>🐺</span> Sarah Chen - Beta Wolf
                                        </h4>
                                        <p className="text-amber-100/90 text-sm mb-4">Baker by day, patrol wolf by night, eternal matchmaker.</p>
                                    </div>
                                    <div>
                                        <h4 className="text-amber-300 font-semibold mb-2 flex items-center gap-2">
                                            <span>🐻</span> Marcus - Werebear
                                        </h4>
                                        <p className="text-amber-100/90 text-sm mb-4">Lumber mill owner and the pack's gentle peacekeeper.</p>
                                        
                                        <h4 className="text-amber-300 font-semibold mb-2 flex items-center gap-2">
                                            <span>🏘️</span> The Community
                                        </h4>
                                        <p className="text-amber-100/90 text-sm">A town where magic and mundane coexist—until secrets demand to be told.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Chapters Section */}
                    {activeTab === 'chapters' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-2 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-4 text-center">
                                Chapter Teasers
                            </h2>
                            <p className="text-amber-300 text-center mb-10">
                                Teasers are shown by default. Use “Show full draft” to open v1 chapters.
                            </p>

                            {/* Chapters List + Reader */}
                            <ChaptersViewer />
                        </div>
                    )}
                    
                    {/* Journey Section */}
                    {activeTab === 'journey' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 plank-shadow pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-8 text-center">
                                The Emotional Journey
                            </h2>
                            <p className="text-xl text-amber-300 text-center mb-16 max-w-3xl mx-auto">
                                Follow Ethan and Caleb through thirteen chapters of slow-burning tension, healing, and rediscovery under the Harvest Moon.
                            </p>
                            
                            {/* Timeline */}
                            <div className="relative">
                                {/* Connection Line */}
                                <div className="absolute left-1/2 top-0 bottom-0 w-1 bg-gradient-to-b from-amber-700 via-orange-600 to-amber-700 transform -translate-x-1/2 hidden md:block"></div>
                                
                                <div className="space-y-12">
                                    {journeyPoints.map((point, idx) => (
                                        <div
                                            key={point.chapter}
                                            className={`flex items-center gap-8 ${idx % 2 === 0 ? 'md:flex-row' : 'md:flex-row-reverse'}`}
                                            onMouseEnter={() => setHoveredChapter(point.chapter)}
                                            onMouseLeave={() => setHoveredChapter(null)}
                                        >
                                            <div className={`flex-1 ${idx % 2 === 0 ? 'text-right' : 'text-left'} hidden md:block`}>
                                                <div className={`inline-block p-6 rounded-lg border transition-all ${
                                                    hoveredChapter === point.chapter
                                                        ? 'bg-amber-900/60 border-amber-600 transform scale-105'
                                                        : 'bg-zinc-900/60 border-amber-800/30'
                                                }`}>
                                                    <h4 className="heading-font text-2xl font-semibold text-amber-200 mb-2">
                                                        Chapter {point.chapter}: {point.title}
                                                    </h4>
                                                    <p className="text-amber-100/80 italic">{point.emotion}</p>
                                                </div>
                                            </div>
                                            
                                            <div className={`w-12 h-12 rounded-full ${point.color} border-4 border-amber-900 flex items-center justify-center font-bold text-white z-10 timeline-dot cursor-pointer`}>
                                                {point.chapter}
                                            </div>
                                            
                                            <div className="flex-1 md:hidden">
                                                <div className={`p-6 rounded-lg border transition-all ${
                                                    hoveredChapter === point.chapter
                                                        ? 'bg-amber-900/60 border-amber-600'
                                                        : 'bg-zinc-900/60 border-amber-800/30'
                                                }`}>
                                                    <h4 className="heading-font text-2xl font-semibold text-amber-200 mb-2">
                                                        Chapter {point.chapter}: {point.title}
                                                    </h4>
                                                    <p className="text-amber-100/80 italic">{point.emotion}</p>
                                                </div>
                                            </div>
                                            
                                            <div className="flex-1 hidden md:block"></div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="mt-16 text-center">
                                <p className="text-amber-300 text-lg italic">
                                    Each chapter deepens the connection, reveals hidden truths, and brings them closer to the moment they must choose: flee again, or finally come home to each other.
                                </p>
                            </div>
                        </div>
                    )}
                    
                    {/* Themes Section */}
                    {activeTab === 'themes' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-1 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-12 text-center">
                                Themes & Atmosphere
                            </h2>
                            
                            <div className="grid md:grid-cols-2 gap-8 mb-12">
                                <div className="bg-gradient-to-br from-orange-900/40 to-red-900/40 p-8 rounded-lg border border-orange-700/50">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🍂 Autumn Atmosphere
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        October fog rolling through ancient forests. Applewood smoke and cinnamon spice. Full moons that hold more power than science allows. Every detail is chosen to evoke the season of transformation.
                                    </p>
                                </div>
                                
                                <div className="bg-gradient-to-br from-amber-900/40 to-yellow-900/40 p-8 rounded-lg border border-amber-700/50">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🌙 Paranormal as Metaphor
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        Shifters represent the parts of ourselves we hide. The full moon embodies transformation. Magic reflects emotional truth—not as gimmick, but as a natural extension of the world and its people.
                                    </p>
                                </div>
                                
                                <div className="bg-gradient-to-br from-slate-800/60 to-slate-900/60 p-8 rounded-lg border border-slate-700/50">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        💔 Healing Old Wounds
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        This isn't a story of first love—it's about second chances. About learning that vulnerability is strength, that coming home can be the bravest journey, and that love rebuilt with intention is worth the risk.
                                    </p>
                                </div>
                                
                                <div className="bg-gradient-to-br from-amber-800/40 to-orange-800/40 p-8 rounded-lg border border-amber-600/50">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        👥 Found Family
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        Maple Hollow isn't just a setting—it's a character. The pack, the town, the community that never forgot Ethan. Belonging matters as much as romance, and both are earned through trust and time.
                                    </p>
                                </div>
                            </div>
                            
                            <div className="bg-zinc-900/60 p-10 rounded-lg border border-amber-800/30 text-center">
                                <h3 className="heading-font text-4xl font-semibold text-amber-200 mb-6">
                                    What to Expect
                                </h3>
                                <div className="grid md:grid-cols-3 gap-6 text-left">
                                    <div>
                                        <p className="font-semibold text-amber-300 mb-2">✨ Slow Burn Romance</p>
                                        <p className="text-sm text-amber-100/80">Tension builds gradually, intimacy is earned, and every touch matters</p>
                                    </div>
                                    <div>
                                        <p className="font-semibold text-amber-300 mb-2">🔥 Heat Level: 4/5</p>
                                        <p className="text-sm text-amber-100/80">Open-door intimacy rooted in emotional connection and vulnerability</p>
                                    </div>
                                    <div>
                                        <p className="font-semibold text-amber-300 mb-2">🕊️ Low Angst</p>
                                        <p className="text-sm text-amber-100/80">Emotionally charged but cozy—no melodrama or manufactured conflict</p>
                                    </div>
                                </div>
                                <div className="mt-8 p-6 bg-amber-900/30 rounded border border-amber-700/30">
                                    <p className="text-amber-100 italic text-lg">
                                        "This book feels like coming home while holding someone's hand in the dark."
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Academy Section */}
                    {activeTab === 'academy' && (
                        <div className="max-w-6xl mx-auto px-6 py-20 bg-image-1 pt-32">
                            <h2 className="heading-font text-5xl font-bold text-amber-100 mb-8 text-center">
                                Future Fiction Academy
                            </h2>
                            
                            <div className="grid md:grid-cols-2 gap-8 mb-8">
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🚀 Project Showcase
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        This website showcases the AI output from a presentation by <strong>Carlo V. Santiago</strong> for Future Fiction Academy. 
                                        The full project files are available at <a href="https://github.com/blossomz37/ffa-skills-project" className="text-amber-300 hover:text-amber-200 underline" target="_blank" rel="noopener noreferrer">GitHub</a>.
                                    </p>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        The goal was to leverage Claude's capabilities (MCP and Skills) to write chapters that meet target word counts, 
                                        enabling independent iteration until goals were achieved.
                                    </p>
                                </div>
                                
                                <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay">
                                    <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4">
                                        🛠️ The Word-Tracker Skill
                                    </h3>
                                    <p className="text-amber-100/90 leading-relaxed mb-4">
                                        We created a custom Skill called <code className="bg-amber-900/30 px-2 py-1 rounded text-amber-300">word-tracker</code> that Claude could use to count and track words, 
                                        providing the data points needed to plan and meet word count goals.
                                    </p>
                                    <p className="text-amber-100/90 leading-relaxed">
                                        While the goal wasn't prose quality (editing is clearly needed!), this exercise serves as a starting point 
                                        for exploring other Skills and MCPs for AI-assisted creative writing.
                                    </p>
                                </div>
                            </div>
                            
                            <div className="bg-zinc-900/60 p-8 rounded-lg border border-amber-800/30 card-texture-overlay mb-8">
                                <h3 className="heading-font text-3xl font-semibold text-amber-200 mb-4 text-center">
                                    🎨 Built with Claude's Skills
                                </h3>
                                <p className="text-amber-100/90 leading-relaxed text-center">
                                    We also used Claude's other built-in Skills to create the branding and design for this website, 
                                    demonstrating the full creative potential of AI-assisted authoring workflows.
                                </p>
                            </div>
                            
                            <div className="bg-gradient-to-br from-amber-900/40 to-orange-900/40 p-8 rounded-lg border border-amber-600/40 text-center">
                                <h3 className="heading-font text-4xl font-semibold text-amber-200 mb-6">
                                    About Future Fiction Academy
                                </h3>
                                <p className="text-amber-100/90 leading-relaxed mb-6 max-w-4xl mx-auto">
                                    This project was created by <strong>Carlo V. Santiago</strong> for the Future Fiction Academy, 
                                    an organization dedicated to helping indie authors and publishers navigate the evolving landscape 
                                    of digital publishing and AI-assisted writing.
                                </p>
                                
                                <div className="grid md:grid-cols-3 gap-4 text-center">
                                    <a href="https://futurefictionacademy.com/" 
                                       className="block bg-amber-900/30 hover:bg-amber-900/50 p-4 rounded-lg border border-amber-700/30 transition-colors" 
                                       target="_blank" rel="noopener noreferrer">
                                        <div className="mb-4 flex justify-center">
                                            <img src="https://xierykaufosmdkcxzfex.supabase.co/storage/v1/object/public/image-gen/FFA-Logo.png" 
                                                 alt="Future Fiction Academy Logo" 
                                                 className="h-12 object-contain" />
                                        </div>
                                        <h4 className="font-semibold text-amber-300 mb-2">📚 Future Fiction Academy</h4>
                                        <p className="text-amber-100/80 text-sm">Empowers authors to harness AI for storytelling by providing knowledge, tools, and community</p>
                                    </a>
                                    
                                    <a href="https://futurefictionpress.com/" 
                                       className="block bg-amber-900/30 hover:bg-amber-900/50 p-4 rounded-lg border border-amber-700/30 transition-colors" 
                                       target="_blank" rel="noopener noreferrer">
                                        <div className="mb-4 flex justify-center">
                                            <img src="https://futurefictionpress.com/wp-content/uploads/2024/07/FFP-Logo-Horizontal-scaled.jpg" 
                                                 alt="Future Fiction Press Logo" 
                                                 className="h-12 object-contain" />
                                        </div>
                                        <h4 className="font-semibold text-amber-300 mb-2">📖 Fresh Reads</h4>
                                        <p className="text-amber-100/80 text-sm">Titles focus on popular genres, leveraging AI for efficient storytelling and marketing</p>
                                    </a>
                                    
                                    <a href="https://www.yourfirstdraft.ai" 
                                       className="block bg-amber-900/30 hover:bg-amber-900/50 p-4 rounded-lg border border-amber-700/30 transition-colors" 
                                       target="_blank" rel="noopener noreferrer">
                                        <div className="mb-4 flex justify-center">
                                            <img src="https://yourfirstdraft.ai/assets/images/Chameleon-opt.png" 
                                                 alt="YourFirstDraft.ai Logo" 
                                                 className="h-12 object-contain" />
                                        </div>
                                        <h4 className="font-semibold text-amber-300 mb-2">✍️ YourFirstDraft.ai</h4>
                                        <p className="text-amber-100/80 text-sm">Beta access - a complete writing ecosystem that transforms story concepts into nearly publishable works.</p>
                                    </a>
                                </div>
                                
                                <p className="text-amber-300 mt-6 italic">
                                    Visit our websites to discover more resources, tutorials, and tools designed specifically for the indie publishing community.
                                </p>
                            </div>
                        </div>
                    )}
                    
                    {/* Footer */}
                    <div className="bg-zinc-950 border-t border-amber-800/30 py-4">
                        <div className="max-w-6xl mx-auto px-6 text-center">
                            <p className="text-amber-500 text-xs">
                                © 2025 • All rights reserved
                            </p>
                        </div>
                    </div>
                </div>
            );
        };
        
        // Simple component to render chapter previews from /chapters/*.md
        const ChaptersViewer = () => {
            const [selected, setSelected] = useState(0);
            const [contentFull, setContentFull] = useState('');
            const [contentPreview, setContentPreview] = useState('');
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [counts, setCounts] = useState({});
            const [showFull, setShowFull] = useState(false);
            const [fallbackNote, setFallbackNote] = useState('');
            const [currentPath, setCurrentPath] = useState('');

            const chapters = CHAPTERS;

            // Respond to quick-jump events from the navbar
            useEffect(() => {
                const handler = (e) => {
                    const idx = e.detail;
                    if (typeof idx === 'number' && idx >= 0 && idx < chapters.length) {
                        setSelected(idx);
                        setShowFull(false);
                        // Scroll the reader into view for convenience
                        try {
                            document.getElementById('root')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        } catch {}
                    }
                };
                window.addEventListener('chapters:select', handler);
                return () => window.removeEventListener('chapters:select', handler);
            }, [chapters.length]);

            
            useEffect(() => {
                const load = async () => {
                    setLoading(true); setError(''); setContentFull(''); setContentPreview(''); setFallbackNote(''); setCurrentPath('');
                    try {
                        const preview = chapters[selected]?.file;
                        const draft = draftsFilenameFor(preview);
                        // Attempt primary target based on toggle
                        const primary = showFull ? `full/${draft}` : preview;
                        const base = new URL(window.location.href);
                        const tryFetch = async (rel) => {
                            const u = new URL(`chapters/${rel}`, base);
                            const r = await fetch(u);
                            return { ok: r.ok, status: r.status, text: r.ok ? await r.text() : '' , rel };
                        };

                        let attempt = await tryFetch(primary);
                        // Fallback: if preview missing and not in showFull mode, try full draft automatically
                        if (!attempt.ok && !showFull) {
                            const alt = `full/${draft}`;
                            const altAttempt = await tryFetch(alt);
                            if (altAttempt.ok) {
                                attempt = altAttempt;
                                setFallbackNote('Preview not available; showing full draft.');
                            }
                        }

                        if (!attempt.ok) {
                            throw new Error(`Failed to load ${primary} (${attempt.status})`);
                        }

                        setCurrentPath(attempt.rel);
                        let md = fixMojibake(attempt.text);
                        // Inject version into first heading if possible
                        const verMatch = draft.match(/_v(\d+)\.md$/);
                        const ver = verMatch ? `v${verMatch[1]}` : '';
                        if (ver) {
                            const injected = md.replace(/^(#\s*.*?Chapter\s+\d+)(\s+—\s+)/m, `$1 ${ver} — `);
                            if (injected !== md) {
                                md = injected;
                            } else {
                                // If no heading match, prepend one derived from chapters array
                                const title = chapters[selected]?.title || 'Chapter';
                                const withVer = title.replace(/(Chapter\s+\d+)/, `$1 ${ver}`);
                                md = `# ${withVer}\n\n${md}`;
                            }
                        }
                        const html = DOMPurify.sanitize(marked.parse(md));
                        setContentFull(html);
                        // Build a preview with first two paragraphs (and keep the first heading if present)
                        try {
                            const container = document.createElement('div');
                            container.innerHTML = html;
                            const out = document.createElement('div');
                            const heading = container.querySelector('h1, h2, h3');
                            if (heading) out.appendChild(heading.cloneNode(true));
                            const paragraphs = container.querySelectorAll('p');
                            let added = 0;
                            for (const p of paragraphs) {
                                out.appendChild(p.cloneNode(true));
                                added++;
                                if (added >= 2) break;
                            }
                            const previewHtml = out.innerHTML || html;
                            setContentPreview(previewHtml);
                        } catch {
                            setContentPreview(html);
                        }
                    } catch (e) {
                        let msg = e.message || 'Failed to load preview.';
                        if (window.location.protocol === 'file:') {
                            msg += ' Tip: When opening this file directly (file://), browsers block fetch. Run a local server from the docs/ folder (e.g., python3 -m http.server) or view via GitHub Pages.';
                        }
                        setError(msg);
                    } finally {
                        setLoading(false);
                    }
                };
                load();
            }, [selected, showFull]);

            // Load word counts CSV once
            useEffect(() => {
                const loadCounts = async () => {
                    try {
                        const base = new URL(window.location.href);
                        const url = new URL('data/word_count_tracker.csv', base);
                        const res = await fetch(url);
                        if (!res.ok) return; // silently ignore
                        const csv = await res.text();
                        const lines = csv.trim().split(/\r?\n/);
                        const header = lines.shift();
                        const map = {};
                        for (const line of lines) {
                            const parts = line.split(',');
                            const filename = parts[0]?.trim();
                            const count = parseInt(parts[1]?.trim(), 10);
                            if (filename && Number.isFinite(count)) {
                                map[filename] = count;
                            }
                        }
                        setCounts(map);
                    } catch {}
                };
                loadCounts();
            }, []);

            const draftsFilenameFor = (file) => file.replace(/\.md$/, '_v1.md');
            const wordsFor = (file) => {
                const key = draftsFilenameFor(file);
                const n = counts[key];
                if (!Number.isFinite(n)) return null;
                return n.toLocaleString();
            };

            return (
                <div className="space-y-6">
                    {/* Chapter Header Card */}
                    <div className="bg-zinc-900/60 border border-amber-800/30 rounded-lg p-6 card-texture-overlay">
                        <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                            <div className="flex-1">
                                <h3 className="heading-font text-2xl font-bold text-amber-200 mb-2">
                                    {chapters[selected]?.title}
                                </h3>
                                <p className="text-amber-300 italic mb-2">{chapters[selected]?.blurb}</p>
                                <p className="text-amber-400 text-sm">
                                    {wordsFor(chapters[selected]?.file) ? `${wordsFor(chapters[selected]?.file)} words` : 'Word count unavailable'}
                                </p>
                            </div>
                            
                            <div className="flex items-center gap-4">
                                <div className="text-amber-300 text-sm">
                                    <label className="inline-flex items-center gap-2 cursor-pointer select-none">
                                        <input type="checkbox" checked={showFull} onChange={() => setShowFull(v => !v)} />
                                        <span>Show full draft</span>
                                    </label>
                                </div>
                                
                                {/* Navigation arrows */}
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setSelected(Math.max(0, selected - 1))}
                                        disabled={selected === 0}
                                        className="px-3 py-1 rounded bg-amber-700 text-white hover:bg-amber-600 transition disabled:opacity-50 disabled:cursor-not-allowed"
                                        title="Previous chapter"
                                    >
                                        ←
                                    </button>
                                    <button
                                        onClick={() => setSelected(Math.min(chapters.length - 1, selected + 1))}
                                        disabled={selected === chapters.length - 1}
                                        className="px-3 py-1 rounded bg-amber-700 text-white hover:bg-amber-600 transition disabled:opacity-50 disabled:cursor-not-allowed"
                                        title="Next chapter"
                                    >
                                        →
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Reader Card */}
                    <div>
                        {fallbackNote && (
                            <p className="text-amber-300 text-sm mb-2">{fallbackNote}</p>
                        )}
                        <div className="bg-zinc-900/60 border border-amber-800/30 rounded-lg p-6 min-h-[32rem] card-texture-overlay">
                            {loading && (
                                <p className="text-amber-300">Loading preview…</p>
                            )}
                            {error && (
                                <p className="text-red-300">{error}</p>
                            )}
                            {!loading && !error && (
                                <article className="chapter-content prose prose-invert max-w-none prose-p:mb-6" dangerouslySetInnerHTML={{ __html: showFull ? contentFull : (contentPreview || contentFull) }} />
                            )}
                        </div>
                        
                        <div className="flex items-center justify-between mt-4">
                            {!loading && !error && !showFull && contentFull && contentPreview && contentPreview !== contentFull && (
                                <button
                                    onClick={() => setShowFull(true)}
                                    className="px-4 py-2 rounded bg-amber-700 text-white hover:bg-amber-600 transition"
                                >
                                    View full chapter
                                </button>
                            )}
                            <div className="ml-auto">
                                <button
                                    onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}
                                    className="px-4 py-2 rounded bg-amber-700 text-white hover:bg-amber-600 transition"
                                    aria-label="Back to top"
                                >
                                    Back to top
                                </button>
                            </div>
                        </div>
                        
                        <div className="mt-4 text-center">
                            <p className="text-amber-400 text-xs italic">
                                Use the dropdown menu above to jump to other chapters • Paragraph spacing increased for easier reading
                            </p>
                        </div>
                    </div>
                </div>
            );
        };


        ReactDOM.render(<MoonlightPromo />, document.getElementById('root'));
    </script>
</body>
</html>
